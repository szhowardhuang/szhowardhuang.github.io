<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.1.1">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha256-wiz7ZSCn/btzhjKDQBms9Hx4sSeUYsDrTLg7roPstac=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.33/fancybox/fancybox.css" integrity="sha256-gkQVf8UKZgQ0HyuxL/VnacadJ+D2Kox2TCEBuNQg5+w=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"szhowardhuang.github.io","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.19.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"æœç´¢...","empty":"æ²¡æœ‰æ‰¾åˆ°ä»»ä½•æœç´¢ç»“æœï¼š${query}","hits_time":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœï¼ˆç”¨æ—¶ ${time} æ¯«ç§’ï¼‰","hits":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœ"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="ä½¿ç”¨ Python ä¸­çš„å¤šè§†å›¾æ‰©æ•£æ¨¡å‹æ¥é‡å»º 3D . é¦–å…ˆæˆ‘ä»¬å»ºç«‹äº†ä¸€ä¸ªé€‚å½“çš„è®¡ç®—ç¯å¢ƒã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦ä¸ºä»»åŠ¡é…ç½®å¿…è¦çš„æ¨¡å‹ã€‚ç„¶åï¼Œæˆ‘ä»¬å¤„ç†å›¾åƒä»¥ç”Ÿæˆå¤šä¸ªè§†å›¾ï¼Œè¿™äº›è§†å›¾æ˜¯åˆ›å»ºæœ€ç»ˆçš„ 3D é‡å»ºå¯¹è±¡æ‰€éœ€çš„ã€‚ æ¯ä¸ªæ­¥éª¤éƒ½ä¼šè¯¦ç»†è®¨è®ºã€‚æˆ‘ä»¬å°†çœ‹åˆ°å¦‚ä½•å‡†å¤‡ç¯å¢ƒï¼Œè®¾ç½®æ¨¡å‹ï¼Œå¹¶ä½¿ç”¨ InstantMesh å°†å›¾åƒä»å•ä¸ªå›¾åƒè½¬æ¢ä¸º 3D é‡å»ºã€‚  InstantMesh çš„ç†è®ºæ¡†æ¶åŠ¨æœºInstantMesh è§£">
<meta property="og:type" content="article">
<meta property="og:title" content="é€šè¿‡å•ä¸ªå›¾åƒè¿›è¡Œ 3D é‡å»º">
<meta property="og:url" content="https://szhowardhuang.github.io/2024/05/28/singleimageto3d/index.html">
<meta property="og:site_name" content="åµŒå…¥å¼è€å…µåšå®¢">
<meta property="og:description" content="ä½¿ç”¨ Python ä¸­çš„å¤šè§†å›¾æ‰©æ•£æ¨¡å‹æ¥é‡å»º 3D . é¦–å…ˆæˆ‘ä»¬å»ºç«‹äº†ä¸€ä¸ªé€‚å½“çš„è®¡ç®—ç¯å¢ƒã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦ä¸ºä»»åŠ¡é…ç½®å¿…è¦çš„æ¨¡å‹ã€‚ç„¶åï¼Œæˆ‘ä»¬å¤„ç†å›¾åƒä»¥ç”Ÿæˆå¤šä¸ªè§†å›¾ï¼Œè¿™äº›è§†å›¾æ˜¯åˆ›å»ºæœ€ç»ˆçš„ 3D é‡å»ºå¯¹è±¡æ‰€éœ€çš„ã€‚ æ¯ä¸ªæ­¥éª¤éƒ½ä¼šè¯¦ç»†è®¨è®ºã€‚æˆ‘ä»¬å°†çœ‹åˆ°å¦‚ä½•å‡†å¤‡ç¯å¢ƒï¼Œè®¾ç½®æ¨¡å‹ï¼Œå¹¶ä½¿ç”¨ InstantMesh å°†å›¾åƒä»å•ä¸ªå›¾åƒè½¬æ¢ä¸º 3D é‡å»ºã€‚  InstantMesh çš„ç†è®ºæ¡†æ¶åŠ¨æœºInstantMesh è§£">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://szhowardhuang.github.io/asset_singlleimageto3d/01.gif">
<meta property="og:image" content="https://szhowardhuang.github.io/asset_singlleimageto3d/02.png">
<meta property="og:image" content="https://szhowardhuang.github.io/asset_singlleimageto3d/03.png">
<meta property="og:image" content="https://szhowardhuang.github.io/asset_singlleimageto3d/04.png">
<meta property="og:image" content="https://szhowardhuang.github.io/asset_singlleimageto3d/05.png">
<meta property="og:image" content="https://szhowardhuang.github.io/asset_singlleimageto3d/06.png">
<meta property="og:image" content="https://szhowardhuang.github.io/asset_singlleimageto3d/07.png">
<meta property="og:image" content="https://szhowardhuang.github.io/asset_singlleimageto3d/02.gif">
<meta property="article:published_time" content="2024-05-28T12:10:00.111Z">
<meta property="article:modified_time" content="2024-06-06T08:12:05.956Z">
<meta property="article:author" content="Howard Huang">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://szhowardhuang.github.io/asset_singlleimageto3d/01.gif">


<link rel="canonical" href="https://szhowardhuang.github.io/2024/05/28/singleimageto3d/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://szhowardhuang.github.io/2024/05/28/singleimageto3d/","path":"2024/05/28/singleimageto3d/","title":"é€šè¿‡å•ä¸ªå›¾åƒè¿›è¡Œ 3D é‡å»º"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>é€šè¿‡å•ä¸ªå›¾åƒè¿›è¡Œ 3D é‡å»º | åµŒå…¥å¼è€å…µåšå®¢</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ " role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">åµŒå…¥å¼è€å…µåšå®¢</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="æœç´¢" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#InstantMesh-%E7%9A%84%E7%90%86%E8%AE%BA%E6%A1%86%E6%9E%B6"><span class="nav-number">1.</span> <span class="nav-text">InstantMesh çš„ç†è®ºæ¡†æ¶</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8A%A8%E6%9C%BA"><span class="nav-number">1.1.</span> <span class="nav-text">åŠ¨æœº</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%83%8C%E6%99%AF%E5%92%8C%E7%9B%B8%E5%85%B3%E5%B7%A5%E4%BD%9C"><span class="nav-number">1.2.</span> <span class="nav-text">èƒŒæ™¯å’Œç›¸å…³å·¥ä½œ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6%E5%92%8C%E5%88%9B%E6%96%B0"><span class="nav-number">1.3.</span> <span class="nav-text">æ ¸å¿ƒç»„ä»¶å’Œåˆ›æ–°</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AE%AD%E7%BB%83%E7%AD%96%E7%95%A5%E5%92%8C%E4%BC%98%E5%8C%96%E6%8A%80%E6%9C%AF"><span class="nav-number">1.4.</span> <span class="nav-text">è®­ç»ƒç­–ç•¥å’Œä¼˜åŒ–æŠ€æœ¯</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B%E5%9B%BE"><span class="nav-number">1.5.</span> <span class="nav-text">å·¥ä½œæµç¨‹å›¾</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A8%A1%E5%9E%8B%E5%8F%98%E4%BD%93%E5%92%8C%E9%85%8D%E7%BD%AE"><span class="nav-number">1.6.</span> <span class="nav-text">æ¨¡å‹å˜ä½“å’Œé…ç½®</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Python-%E5%AE%9E%E7%8E%B0"><span class="nav-number">2.</span> <span class="nav-text">Python å®ç°</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%8E%AF%E5%A2%83%E8%AE%BE%E7%BD%AE"><span class="nav-number">2.1.</span> <span class="nav-text">ç¯å¢ƒè®¾ç½®</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A8%A1%E5%9E%8B%E5%88%9D%E5%A7%8B%E5%8C%96"><span class="nav-number">2.2.</span> <span class="nav-text">æ¨¡å‹åˆå§‹åŒ–</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86%E5%92%8C%E5%A4%9A%E8%A7%86%E5%9B%BE%E5%90%88%E6%88%90%E5%8A%9F%E8%83%BD"><span class="nav-number">2.3.</span> <span class="nav-text">å›¾åƒå¤„ç†å’Œå¤šè§†å›¾åˆæˆåŠŸèƒ½</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9B%BE%E5%83%8F%E5%8A%A0%E8%BD%BD%E3%80%81%E5%A4%84%E7%90%86%E5%92%8C%E5%A4%9A%E8%A7%86%E5%9B%BE%E7%94%9F%E6%88%90"><span class="nav-number">2.4.</span> <span class="nav-text">å›¾åƒåŠ è½½ã€å¤„ç†å’Œå¤šè§†å›¾ç”Ÿæˆ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A8%A1%E5%9E%8B%E9%85%8D%E7%BD%AE"><span class="nav-number">2.5.</span> <span class="nav-text">æ¨¡å‹é…ç½®</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3D-%E6%A8%A1%E5%9E%8B%E7%94%9F%E6%88%90%E5%92%8C%E5%8F%AF%E8%A7%86%E5%8C%96%E7%9A%84%E5%8A%9F%E8%83%BD"><span class="nav-number">2.6.</span> <span class="nav-text">3D æ¨¡å‹ç”Ÿæˆå’Œå¯è§†åŒ–çš„åŠŸèƒ½</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%82%E8%80%83"><span class="nav-number">3.</span> <span class="nav-text">å‚è€ƒ</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Howard Huang</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">55</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://szhowardhuang.github.io/2024/05/28/singleimageto3d/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Howard Huang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="åµŒå…¥å¼è€å…µåšå®¢">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="é€šè¿‡å•ä¸ªå›¾åƒè¿›è¡Œ 3D é‡å»º | åµŒå…¥å¼è€å…µåšå®¢">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          é€šè¿‡å•ä¸ªå›¾åƒè¿›è¡Œ 3D é‡å»º
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2024-05-28 20:10:00" itemprop="dateCreated datePublished" datetime="2024-05-28T20:10:00+08:00">2024-05-28</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">æ›´æ–°äº</span>
      <time title="ä¿®æ”¹æ—¶é—´ï¼š2024-06-06 16:12:05" itemprop="dateModified" datetime="2024-06-06T16:12:05+08:00">2024-06-06</time>
    </span>

  
    <span class="post-meta-item" title="é˜…è¯»æ¬¡æ•°" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
      <span>19k</span>
    </span>
    <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
      <span>34 åˆ†é’Ÿ</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>ä½¿ç”¨ Python ä¸­çš„å¤šè§†å›¾æ‰©æ•£æ¨¡å‹æ¥é‡å»º 3D .</p>
<p>é¦–å…ˆæˆ‘ä»¬å»ºç«‹äº†ä¸€ä¸ªé€‚å½“çš„è®¡ç®—ç¯å¢ƒã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦ä¸ºä»»åŠ¡é…ç½®å¿…è¦çš„æ¨¡å‹ã€‚ç„¶åï¼Œæˆ‘ä»¬å¤„ç†å›¾åƒä»¥ç”Ÿæˆå¤šä¸ªè§†å›¾ï¼Œè¿™äº›è§†å›¾æ˜¯åˆ›å»ºæœ€ç»ˆçš„ 3D é‡å»ºå¯¹è±¡æ‰€éœ€çš„ã€‚</p>
<p>æ¯ä¸ªæ­¥éª¤éƒ½ä¼šè¯¦ç»†è®¨è®ºã€‚æˆ‘ä»¬å°†çœ‹åˆ°å¦‚ä½•å‡†å¤‡ç¯å¢ƒï¼Œè®¾ç½®æ¨¡å‹ï¼Œå¹¶ä½¿ç”¨ <a target="_blank" rel="noopener" href="https://github.com/Entreprenerdly/InstantMesh">InstantMesh</a> å°†å›¾åƒä»å•ä¸ªå›¾åƒè½¬æ¢ä¸º 3D é‡å»ºã€‚</p>
<p><img src="/../asset_singlleimageto3d/01.gif"></p>
<h2 id="InstantMesh-çš„ç†è®ºæ¡†æ¶"><a href="#InstantMesh-çš„ç†è®ºæ¡†æ¶" class="headerlink" title="InstantMesh çš„ç†è®ºæ¡†æ¶"></a>InstantMesh çš„ç†è®ºæ¡†æ¶</h2><h3 id="åŠ¨æœº"><a href="#åŠ¨æœº" class="headerlink" title="åŠ¨æœº"></a>åŠ¨æœº</h3><p>InstantMesh è§£å†³äº†ä»å•ä¸ªå›¾åƒè¿›è¡Œ 3D é‡å»ºçš„æŒ‘æˆ˜ï¼Œè¿™å¯¹è™šæ‹Ÿç°å®å’ŒåŠ¨ç”»ç­‰åº”ç”¨éå¸¸é‡è¦ã€‚æœ‰é™çš„ 3D æ•°æ®å’Œä¸å®Œå–„çš„æ³¨é‡Šå†æ¥ä½¿å¾—è¿™é¡¹ä»»åŠ¡å›°éš¾ã€‚ç„¶è€Œï¼ŒInstantMesh åˆ©ç”¨å¤§è§„æ¨¡æ‰©æ•£æ¨¡å‹å’Œæ–°é¢–çš„æ¶æ„æ¥å¢å¼º 3D ç½‘æ ¼ç”Ÿæˆã€‚</p>
<h3 id="èƒŒæ™¯å’Œç›¸å…³å·¥ä½œ"><a href="#èƒŒæ™¯å’Œç›¸å…³å·¥ä½œ" class="headerlink" title="èƒŒæ™¯å’Œç›¸å…³å·¥ä½œ"></a>èƒŒæ™¯å’Œç›¸å…³å·¥ä½œ</h3><p>å…ˆå‰çš„ç ”ç©¶å·²ç»å°† 2D æ‰©æ•£æ‰©å±•åˆ° 3D ç©ºé—´ï¼Œä½¿ç”¨äº†è¯¸å¦‚å¾—åˆ†è’¸é¦é‡‡æ ·ï¼ˆSDSï¼‰å’Œå¤§å‹é‡å»ºæ¨¡å‹ï¼ˆLRMsï¼‰è¿™æ ·çš„æ–¹æ³•ï¼Œç›´æ¥å°†å›¾åƒæ ‡è®°æ˜ å°„åˆ° 3D è¡¨ç¤ºã€‚</p>
<h3 id="æ ¸å¿ƒç»„ä»¶å’Œåˆ›æ–°"><a href="#æ ¸å¿ƒç»„ä»¶å’Œåˆ›æ–°" class="headerlink" title="æ ¸å¿ƒç»„ä»¶å’Œåˆ›æ–°"></a>æ ¸å¿ƒç»„ä»¶å’Œåˆ›æ–°</h3><p>å¤šè§†è§’æ‰©æ•£æ¨¡å‹ï¼ˆMVDï¼‰ã€‚è¯¥ç»„ä»¶ä»å•ä¸ªå›¾åƒä¸­åˆæˆå¤šä¸ªè§†å›¾ï¼Œç”¨äºæ„å»º 3D æ¨¡å‹ã€‚æ­¤å¤–ï¼Œå®ƒä½¿ç”¨äº† <a target="_blank" rel="noopener" href="https://stability.ai/news/stable-zero123-3d-generation">Zero123++æ¨¡å‹</a>çš„ä¿®æ”¹ç‰ˆæœ¬ï¼Œç»è¿‡ä¼˜åŒ–ä»¥é€šè¿‡åœ¨ç”Ÿæˆçš„å›¾åƒä¸­ä¿æŒä¸€è‡´çš„èƒŒæ™¯æ¥å‡å°‘ä¼ªå½±ã€‚</p>
<p>MVD çš„æ•°å­¦è¡¨è¾¾ã€‚</p>
<p><img src="/../asset_singlleimageto3d/02.png"></p>
<p>æ‰©æ•£æ¨¡å‹ä½¿ç”¨ç”±ğœƒè¡¨ç¤ºçš„å‚æ•°ï¼Œç»è¿‡å¾®è°ƒä»¥ç”Ÿæˆä¸€è‡´çš„èƒŒæ™¯ï¼Œä»¥ğ¼ä½œä¸ºè¾“å…¥å›¾åƒï¼Œå¹¶åˆæˆå¤šè§†è§’å›¾åƒğ¼â€²ã€‚</p>
<p>ç¨€ç–è§†å›¾å¤§å‹é‡å»ºæ¨¡å‹ï¼ˆLRMï¼‰ã€‚ä½¿ç”¨åŸºäº Transformer çš„æ¶æ„ï¼Œèƒ½å¤Ÿå¤„ç†ç¨€ç–è¾“å…¥ï¼ŒLRM å°†å¤šè§†å›¾å›¾åƒè½¬æ¢ä¸º 3D ç½‘æ ¼ã€‚</p>
<p>ç­‰å€¼é¢æå–ï¼ˆFlexiCubesï¼‰ã€‚</p>
<p><img src="/../asset_singlleimageto3d/03.png"></p>
<p>ğ‘€æ˜¯ç½‘æ ¼è¾“å‡ºï¼Œğ‘‰ä»£è¡¨ LRM ä¸­çš„ä½“ç§¯æ•°æ®ï¼Œğœ™æ˜¯ FlexiCubes æ¨¡å—çš„å‚æ•°ï¼Œå®ƒä»¬ç›´æ¥åº”ç”¨äºç½‘æ ¼ä¸Šçš„å‡ ä½•çº¦æŸã€‚</p>
<h3 id="è®­ç»ƒç­–ç•¥å’Œä¼˜åŒ–æŠ€æœ¯"><a href="#è®­ç»ƒç­–ç•¥å’Œä¼˜åŒ–æŠ€æœ¯" class="headerlink" title="è®­ç»ƒç­–ç•¥å’Œä¼˜åŒ–æŠ€æœ¯"></a>è®­ç»ƒç­–ç•¥å’Œä¼˜åŒ–æŠ€æœ¯</h3><p>æ•°æ®å‡†å¤‡å’Œè®­ç»ƒç­–ç•¥ï¼šè®­ç»ƒé‡‡ç”¨ä¸¤é˜¶æ®µæ–¹æ³•ï¼Œé¦–å…ˆä¾§é‡äº NeRF è¡¨ç¤ºï¼Œç„¶åè¿‡æ¸¡åˆ°ç½‘æ ¼ä¼˜åŒ–ã€‚</p>
<p>é˜¶æ®µ 1ï¼šåŸºäº NeRF çš„è®­ç»ƒã€‚</p>
<p>è¿™ä¸ªé˜¶æ®µçš„é‡ç‚¹æ˜¯åˆ©ç”¨ NeRF çš„ä½“ç§¯æ¸²æŸ“èƒ½åŠ›å»ºç«‹ä¸€ä¸ªå¼ºå¤§çš„åŸºç¡€æ¨¡å‹ã€‚ç›®æ ‡æ˜¯å­¦ä¹ ä¸€ä¸ªåˆå§‹è¡¨ç¤ºï¼Œä»åˆæˆçš„å¤šè§†è§’å›¾åƒä¸­æ•æ‰æ•´ä½“å½¢çŠ¶å’Œå¤–è§‚ã€‚</p>
<p><img src="/../asset_singlleimageto3d/04.png"></p>
<p>ğ¼^ğ‘–å’Œğ‘€^ğ‘–æ˜¯é¢„æµ‹å›¾åƒå’Œæ©æ¨¡ï¼Œğ¼ğ‘”ğ‘¡ğ‘–å’Œğ‘€ğ‘”ğ‘¡ğ‘–æ˜¯å®é™…å›¾åƒå’Œæ©æ¨¡ï¼Œğœ†å€¼æ˜¯æ­£åˆ™åŒ–ç³»æ•°ã€‚</p>
<p>é˜¶æ®µ 2ï¼šåŸºäºç½‘æ ¼çš„ä¼˜åŒ–ã€‚</p>
<p>è¿™ä¸ªé˜¶æ®µè½¬å‘åŸºäºç½‘æ ¼çš„æ–¹æ³•ï¼Œå…¶ä¸­ä½¿ç”¨ FlexiCubes æ¥ç»†åŒ–è¡¨é¢ç»†èŠ‚å¹¶æé«˜ç½‘æ ¼çš„å‡ ä½•ç²¾åº¦ã€‚æ­¤å¤–ï¼Œåœ¨è¿™ä¸ªé˜¶æ®µï¼Œä» NeRF ä¸­å­¦åˆ°çš„åˆæ­¥çŸ¥è¯†è¢«åˆ©ç”¨æ¥ä¸“æ³¨äºå¢å¼ºè¡¨é¢ç»†èŠ‚å¹¶åº”ç”¨é€¼çœŸçš„çº¹ç†ã€‚</p>
<p><img src="/../asset_singlleimageto3d/05.png"></p>
<p>ğ·^ğ‘–å’Œğ‘^ğ‘–æ˜¯é¢„æµ‹çš„æ·±åº¦å›¾å’Œæ³•çº¿å›¾ï¼Œğ·ğ‘”ğ‘¡ğ‘–å’Œğ‘ğ‘”ğ‘¡ğ‘–æ˜¯åœ°é¢çœŸå®å€¼ï¼ŒâŠ—è¡¨ç¤ºé€å…ƒç´ ä¹˜æ³•ï¼Œğ¿reg æ˜¯ FlexiCubes çš„æ­£åˆ™åŒ–é¡¹ã€‚</p>
<p>ç›¸æœºå¢å¼ºå’Œæ‰°åŠ¨æŠ€æœ¯ã€‚å¢å¼ºåŒ…æ‹¬å¯¹ç›¸æœºå§¿åŠ¿è¿›è¡Œéšæœºæ—‹è½¬å’Œç¼©æ”¾ï¼Œä»¥æé«˜æ¨¡å‹å¯¹ä¸åŒè¾“å…¥çš„ç¨³å¥æ€§ã€‚</p>
<p>ä¼˜åŒ–æŠ€æœ¯:</p>
<ul>
<li>AdaLNï¼ˆè‡ªé€‚åº”å±‚å½’ä¸€åŒ–ï¼‰ï¼šæ­¤æŠ€æœ¯ç”¨äºtransformer å†…ï¼Œä»¥è°ƒæ•´æ¨¡å‹å¯¹ä¸åŒç›¸æœºå§¿åŠ¿çš„æ•æ„Ÿæ€§ï¼Œä»è€Œæé«˜å…¶åœ¨å„ç§è§†è§’ä¸‹çš„æ³›åŒ–èƒ½åŠ›ã€‚</li>
<li>æ­£è§„åŒ–å’Œç›‘ç£ï¼šæ·±åº¦å’Œæ³•çº¿ç›‘ç£å¯¹äºä¼˜åŒ–æ¨¡å‹çš„è¾“å‡ºè‡³å…³é‡è¦ã€‚æ­¤å¤–ï¼Œå®ƒç¡®ä¿ 3D ç½‘æ ¼åœ¨è§†è§‰ä¸Šç±»ä¼¼äºè¾“å…¥ï¼Œå¹¶ä¸”ç¬¦åˆç‰©ç†å°ºå¯¸å’Œæ–¹å‘ã€‚</li>
</ul>
<p>æŸå¤±å‡½æ•°ç»„ä»¶:</p>
<ul>
<li>æ·±åº¦å’Œæ³•çº¿ç›‘ç£ã€‚é€šè¿‡å°†é¢„æµ‹çš„æ·±åº¦å›¾å’Œæ³•çº¿ä¸å®ƒä»¬çš„åœ°é¢çœŸå®å¯¹åº”ç‰©è¿›è¡Œæ¯”è¾ƒï¼Œå¢å¼ºæ¨¡å‹é¢„æµ‹å‡†ç¡®å‡ ä½•å±æ€§çš„èƒ½åŠ›ã€‚</li>
<li>æ­£åˆ™åŒ–é¡¹ã€‚åŒ…æ‹¬ç»´æŒç½‘æ ¼å®Œæ•´æ€§ã€é˜²æ­¢è¿‡æ‹Ÿåˆå’Œé¼“åŠ±ç”Ÿæˆç½‘æ ¼å¹³æ»‘çš„é¡¹ã€‚</li>
</ul>
<h3 id="å·¥ä½œæµç¨‹å›¾"><a href="#å·¥ä½œæµç¨‹å›¾" class="headerlink" title="å·¥ä½œæµç¨‹å›¾"></a>å·¥ä½œæµç¨‹å›¾</h3><p>ä¸‹é¢çš„å›¾è¡¨ä»£è¡¨äº† InstantMesh æ¡†æ¶çš„å·¥ä½œæµç¨‹ï¼Œç”¨äºä»å•ä¸ªå›¾åƒç”Ÿæˆ 3D é‡å»ºã€‚ä»¥ä¸‹æ˜¯å›¾è¡¨ä¸­æ¯ä¸ªç»„ä»¶å¦‚ä½•äº§ç”Ÿä½œç”¨ï¼š</p>
<ul>
<li><p>è¾“å…¥å›¾åƒã€‚æµç¨‹å§‹äºå•ä¸ªè¾“å…¥å›¾åƒï¼Œå›¾ç¤ºä¸ºä¸€ä¸ªæ’å›¾äººç‰©ã€‚</p>
</li>
<li><p>å¤šè§†è§’æ‰©æ•£æ¨¡å‹ã€‚ç”Ÿæˆè¾“å…¥å›¾åƒçš„å¤šä¸ªè§†å›¾ï¼Œè¯¥æ¨¡å‹å¢å¼ºäº†è¿›è¡Œ 3D é‡å»ºæ‰€éœ€çš„ç©ºé—´ç†è§£ã€‚æ¥ä¸‹æ¥ï¼Œè§†å›¾è¢«å±•ç¤ºä¸ºäººç‰©çš„å‡ ä¸ªä¸åŒè§†è§’ï¼Œæœ‰åŠ©äºå…¨é¢æ•æ‰å…¶ 3D ç»“æ„ã€‚</p>
</li>
<li><p>ç¨€ç–è§†å›¾å¤§é‡å»ºæ¨¡å‹ã€‚è¯¥æ¨¡å‹ç”±å‡ ä¸ªå…³é”®ç»„ä»¶ç»„æˆï¼š</p>
<ul>
<li>ViT ç¼–ç å™¨ã€‚å¤„ç†å¤šè§†å›¾å›¾åƒï¼Œè§†è§‰ Transformerï¼ˆViTï¼‰ç¼–ç å™¨å°†å®ƒä»¬è½¬æ¢ä¸ºä¸€ç³»åˆ—å›¾åƒæ ‡è®°ï¼Œè¿™äº›æ ‡è®°å°è£…äº†æ¯ä¸ªè§†å›¾çš„å…³é”®ç‰¹å¾ã€‚</li>
<li>ä¸‰å±‚é¢è§£ç å™¨ã€‚è¯¥ç»„ä»¶å°†å›¾åƒä»¤ç‰Œè§£ç ä¸ºä¸‰å±‚é¢è¡¨ç¤ºï¼Œè¿™æ˜¯ä¸€ç§ä¸‰ç»´æ ¼å¼ï¼Œç”¨ä½œæœ€ç»ˆç½‘æ ¼ç”Ÿæˆä¹‹å‰çš„ä¸­é—´æ­¥éª¤ã€‚</li>
<li>FlexiCubesã€‚ä½œä¸ºç­‰å€¼é¢æå–æ¨¡å—ï¼ŒFlexiCubes å°†ä¸‰é¢æ•°æ®è½¬æ¢ä¸ºç½‘æ ¼ï¼Œç›´æ¥åº”ç”¨å‡ ä½•ç›‘ç£æ¥ç»†åŒ–å’Œè¯¦ç»†åŒ– 3D è¾“å‡ºã€‚</li>
</ul>
</li>
<li><p>128Â³ ç½‘æ ¼ã€‚è¯¥ç½‘æ ¼ç»“æ„ä¸º 128x128x128ï¼Œç½‘æ ¼çªå‡ºäº†æœ€ç»ˆ 3D æ¨¡å‹ä¸­æ•æ‰åˆ°çš„åˆ†è¾¨ç‡å’Œç»†èŠ‚ã€‚</p>
</li>
<li><p>æ¸²æŸ“ã€‚ä»å„ä¸ªè§’åº¦æ¸²æŸ“ï¼Œæœ€ç»ˆçš„ç½‘æ ¼å±•ç¤ºäº†å®Œæˆçš„ 3D æ¨¡å‹ï¼Œå¹¶å±•ç¤ºäº†è¯¥æ¨¡å‹åœ¨æ•æ‰åŸå§‹è¾“å…¥çš„å…¨é¢å‡ ä½•ç»†èŠ‚æ–¹é¢çš„æœ‰æ•ˆæ€§ã€‚</p>
</li>
</ul>
<p><img src="/../asset_singlleimageto3d/06.png"></p>
<h3 id="æ¨¡å‹å˜ä½“å’Œé…ç½®"><a href="#æ¨¡å‹å˜ä½“å’Œé…ç½®" class="headerlink" title="æ¨¡å‹å˜ä½“å’Œé…ç½®"></a>æ¨¡å‹å˜ä½“å’Œé…ç½®</h3><p>InstantMesh æä¾›äº†å‡ ç§æ¨¡å‹å˜ä½“ï¼Œä»¥æ»¡è¶³å„ç§è®¡ç®—éœ€æ±‚å’Œåº”ç”¨åœºæ™¯ã€‚</p>
<p>è¿™äº›å˜ä½“æ ¹æ®å®ƒä»¬çš„ 3D è¡¨ç¤ºï¼ˆNeRF vs. Meshï¼‰å’Œå‚æ•°è§„æ¨¡ï¼ˆbase vs. largeï¼‰åˆ†ä¸ºä¸åŒç±»åˆ«ã€‚</p>
<p>æ¨¡å‹å˜ä½“çš„å‚æ•°é…ç½®:</p>
<ul>
<li>NeRF å’Œ Mesh å˜ä½“ã€‚NeRF å˜ä½“æœ€åˆé‡‡ç”¨ç¥ç»è¾å°„åœºæ–¹æ³•ï¼Œæ“…é•¿æ•æ‰å¤æ‚çš„ä½“ç§¯ç»†èŠ‚ã€‚å¦ä¸€æ–¹é¢ï¼ŒMesh å˜ä½“ä»ä¸€å¼€å§‹å°±é‡‡ç”¨ç½‘æ ¼è¡¨ç¤ºï¼Œå®ç°ç›´æ¥çš„å‡ ä½•æ“ä½œï¼Œé€šå¸¸ä½¿ç”¨ FlexiCubes æ¨¡å—å¯ä»¥å®ç°æ›´å¿«çš„å¤„ç†æ—¶é—´ã€‚</li>
<li>åŸºç¡€å’Œå¤§å‹æ¨¡å‹ã€‚transformer ç½‘ç»œçš„å¤§å°ä»¥åŠä¸‰è§’é¢æˆ–ç½‘æ ¼è¡¨ç¤ºçš„å¤æ‚æ€§æ¥åŒºåˆ†è¿™äº›é…ç½®ã€‚æ›´å¤§çš„æ¨¡å‹æ—¨åœ¨å¤„ç†æ›´å¤æ‚çš„åœºæ™¯ï¼Œä½†éœ€è¦æ›´å¤šçš„è®¡ç®—èµ„æºã€‚</li>
</ul>
<table>
<thead>
<tr>
<th>Model</th>
<th>Representation</th>
<th>Input Views</th>
<th>Transformer Layers</th>
<th>Triplane&#x2F;Mesh Details</th>
</tr>
</thead>
<tbody><tr>
<td>InstantNeRF</td>
<td>NeRF</td>
<td>6</td>
<td>12 (Base) &#x2F; 16 (Large)</td>
<td>Triplane 64x64</td>
</tr>
<tr>
<td>InstantMesh</td>
<td>Mesh</td>
<td>6</td>
<td>12 (Base) &#x2F; 16 (Large)</td>
<td>Mesh grid size 128x128</td>
</tr>
</tbody></table>
<h2 id="Python-å®ç°"><a href="#Python-å®ç°" class="headerlink" title="Python å®ç°"></a>Python å®ç°</h2><h3 id="ç¯å¢ƒè®¾ç½®"><a href="#ç¯å¢ƒè®¾ç½®" class="headerlink" title="ç¯å¢ƒè®¾ç½®"></a>ç¯å¢ƒè®¾ç½®</h3><p>ä» GitHub å…‹éš†â€˜InstantMeshâ€™å­˜å‚¨åº“ï¼Œ<a target="_blank" rel="noopener" href="https://github.com/Entreprenerdly/InstantMesh">https://github.com/Entreprenerdly/InstantMesh</a> ,  å®‰è£…å„ç§ Python åº“çš„ç‰¹å®šç‰ˆæœ¬ã€‚å…¶ä¸­åŒ…æ‹¬æ·±åº¦å­¦ä¹  ( pytorch-lightning , torchmetrics )ï¼Œä»¥åŠå…¶ä»–å®ç”¨å·¥å…· ( einops , omegaconf )ã€‚</p>
<ul>
<li>PyMCubes å’Œ trimesh ç”¨äºç½‘æ ¼å¤„ç†ã€‚æå–ç­‰å€¼é¢ï¼ˆå°† 3D ä½“ç´ æ•°æ®è½¬æ¢ä¸ºç½‘æ ¼ï¼‰éœ€è¦ PyMCubes ã€‚ç›¸åï¼Œ trimesh ç”¨äºè½»æ¾æ“ä½œå’ŒæŸ¥çœ‹ 3D ç½‘æ ¼æ•°æ®ã€‚</li>
<li>rembg ç”¨äºä»å›¾åƒä¸­å»é™¤èƒŒæ™¯ï¼Œå¯¹äºéœ€è¦å°†å›¾åƒä¸»é¢˜éš”ç¦»å‡ºæ¥çš„å¤„ç†è‡³å…³é‡è¦ã€‚</li>
<li>nvdiffrast å’Œ jax å’Œ jaxlib. è¿™äº›åº“å¯¹å¯å¾®å…‰æ …åŒ–å’Œæ•°å€¼è®¡ç®—æ˜¯å¿…éœ€çš„ï¼Œä»è€Œå®ç°åŸºäºæ¢¯åº¦ä¸‹é™çš„å¤æ‚ 3D å‡ ä½•ä¼˜åŒ–ã€‚</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">pip install torch==2.1.0 torchvision==0.16.0 torchaudio==2.1.0 --index-url https://download.pytorch.org/whl/cu121</span><br><span class="line">pip install xformers==0.0.22.post7</span><br><span class="line">pip install -r requirements.txt</span><br><span class="line">pip install ninja</span><br><span class="line">pip install bitsandbytes-windows</span><br></pre></td></tr></table></figure>
<p>windowsç³»ç»Ÿè¦å®‰è£… bitsandbytes-windows</p>
<p>å½“è¿è¡Œ app.py æ—¶ï¼Œ</p>
<p>å¦‚æœç¢°åˆ°ninjaç¼–è¯‘çš„é—®é¢˜ï¼š</p>
<ul>
<li>å®‰è£… å¾®è½¯ vs_BuildTools ï¼Œç„¶åé€‰æ‹©å®‰è£… win10 SDK</li>
</ul>
<p>å¦‚æœç¼–è¯‘CUDAæ—¶ï¼ŒæŠ¥å‘Šä¸æ”¯æŒçš„VSç‰ˆæœ¬é”™è¯¯ï¼Œç›´æ¥ä¿®æ”¹CUDAç›¸åº”çš„headeræ–‡ä»¶ï¼š </p>
<p>C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\vxx.x\include\crt&#x2F;host_config.h</p>
<p>è¯·çœ‹logè¿›å…¥å…·ä½“çš„æ–‡ä»¶ï¼Œä¿®æ”¹_MSC_VERçš„æ¯”è¾ƒå€¼, è®©ç‰ˆæœ¬é”™è¯¯æ¶ˆå¤±ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#if defined(_WIN32)</span><br><span class="line"></span><br><span class="line">#if _MSC_VER &lt; 1910 || _MSC_VER &gt;= 2000</span><br></pre></td></tr></table></figure>

<p>å› ä¸ºgradioçš„å®‰è£…ç‰ˆæœ¬ä¸å¥½æ§åˆ¶ï¼Œå¦‚æœè¢«é€¼å®‰è£…åˆ°æ–°çš„ç‰ˆæœ¬ï¼Œéœ€è¦ä¿®æ”¹ app.pyçš„ä»£ç ï¼ŒæŠŠ width&#x3D;768 æ”¹æˆ min_width&#x3D;768</p>
<p>æ­¤å¤–ï¼Œéœ€è¦16G VRAMä»¥ä¸Šçš„æ˜¾å¡ã€‚</p>
<h3 id="æ¨¡å‹åˆå§‹åŒ–"><a href="#æ¨¡å‹åˆå§‹åŒ–" class="headerlink" title="æ¨¡å‹åˆå§‹åŒ–"></a>æ¨¡å‹åˆå§‹åŒ–</h3><p>æ¨¡å‹ç®¡é“è®¾ç½®:</p>
<ul>
<li>ä¸€ä¸ª DiffusionPipeline æ˜¯ä»ä¸€ä¸ªé¢„è®­ç»ƒæ¨¡å‹å®ä¾‹åŒ–çš„ã€‚è¿™ä¸ªæ¨¡å‹ï¼Œç”± sudo-ai&#x2F;zero123plus-v1.2 æ ‡è¯†ï¼Œä¸“é—¨é…ç½®ä¸ºä»¥åŠç²¾åº¦ï¼ˆ torch_dtype&#x3D;torch.float16 ï¼‰è¿è¡Œã€‚</li>
<li>æ‰©æ•£æ¨¡å‹çš„è°ƒåº¦ç¨‹åºé…ç½®ä¸º trailing æ—¶é—´æ­¥è·ã€‚è¯¥é…ç½®å½±å“äº†æ‰©æ•£æ­¥éª¤çš„è®¡ç®—æ–¹å¼ï¼Œä¼˜åŒ–äº†å›¾åƒåˆæˆè¿‡ç¨‹ä¸­é™å™ªè¿›ç¨‹çš„å¤„ç†ã€‚</li>
</ul>
<p>æ¨¡å‹åŠ è½½ï¼š</p>
<ul>
<li>ä» Hugging Face Hubï¼ˆ hf_hub_download ï¼‰ä¸‹è½½æ¨¡å‹ï¼Œå¹¶å°†å…¶åŠ è½½åˆ°æ¨¡å‹ï¼ˆ pipeline.unet.load_state_dict(state_dict, strict&#x3D;True) ï¼‰ä¸­ï¼Œç¡®ä¿æˆ‘ä»¬æ‹¥æœ‰å‡†å¤‡éƒ¨ç½²çš„ç²¾ç¡®è®­ç»ƒå‚æ•°ã€‚</li>
</ul>
<p>è®¾å¤‡é…ç½®:</p>
<ul>
<li>å°†è®¡ç®—è®¾å¤‡è®¾ç½®ä¸º GPUï¼ˆ device &#x3D; torch.device(â€˜cudaâ€™) ï¼‰å¹¶å°†ç®¡é“ç§»åŠ¨åˆ°è¯¥è®¾å¤‡ï¼ˆ pipeline &#x3D; pipeline.to(device) ï¼‰æ˜¯æ·±åº¦å­¦ä¹ ä»»åŠ¡çš„æ ‡å‡†åšæ³•ã€‚</li>
</ul>
<p>å¯é‡å¤æ€§:</p>
<ul>
<li>ä¸€ä¸ªéšæœºç§å­ï¼ˆ seed_everything(0) ï¼‰å¯ä»¥ç¡®ä¿æ¨¡å‹çš„è¾“å‡ºæ˜¯ç¡®å®šæ€§çš„å’Œå¯é‡ç°çš„ã€‚è¿™åœ¨ç§‘å­¦å®éªŒå’Œäº§å“å¼€å‘ä¸­å°¤ä¸ºé‡è¦ã€‚</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Load libraries</span></span><br><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="comment"># Empty Cache and clear any previous model references</span></span><br><span class="line">model = <span class="literal">None</span></span><br><span class="line">torch.cuda.empty_cache()</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> rembg</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> pytorch_lightning <span class="keyword">import</span> seed_everything</span><br><span class="line"><span class="keyword">from</span> einops <span class="keyword">import</span> rearrange</span><br><span class="line"><span class="keyword">from</span> diffusers <span class="keyword">import</span> DiffusionPipeline, EulerAncestralDiscreteScheduler</span><br><span class="line"><span class="keyword">from</span> huggingface_hub <span class="keyword">import</span> hf_hub_download</span><br><span class="line"><span class="keyword">from</span> src.utils.infer_util <span class="keyword">import</span> remove_background, resize_foreground</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Initialize a DiffusionPipeline with a pretrained model specified by its identifier.</span></span><br><span class="line"><span class="comment"># This model uses a custom pipeline setting and operates at half precision (float16) to enhance performance on compatible GPUs.</span></span><br><span class="line">pipeline = DiffusionPipeline.from_pretrained(<span class="string">&quot;sudo-ai/zero123plus-v1.2&quot;</span>, custom_pipeline=<span class="string">&quot;zero123plus&quot;</span>, torch_dtype=torch.float16)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Configure the pipeline&#x27;s scheduler, setting the timestep spacing to &#x27;trailing&#x27; which affects how steps are calculated in the diffusion process.</span></span><br><span class="line">pipeline.scheduler = EulerAncestralDiscreteScheduler.from_config(pipeline.scheduler.config, timestep_spacing=<span class="string">&#x27;trailing&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Download the model checkpoint from the Hugging Face Hub, specifying the repository and the file name.</span></span><br><span class="line">unet_ckpt_path = hf_hub_download(repo_id=<span class="string">&quot;TencentARC/InstantMesh&quot;</span>, filename=<span class="string">&quot;diffusion_pytorch_model.bin&quot;</span>, repo_type=<span class="string">&quot;model&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Load the state dictionary of the model from the downloaded checkpoint, ensuring it&#x27;s loaded to CPU memory first.</span></span><br><span class="line">state_dict = torch.load(unet_ckpt_path, map_location=<span class="string">&#x27;cpu&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Load the state dictionary into the UNet model within the pipeline, ensuring strict loading to match all model parameters exactly.</span></span><br><span class="line">pipeline.unet.load_state_dict(state_dict, strict=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Set the device for model computation to GPU for faster processing if available.</span></span><br><span class="line">device = torch.device(<span class="string">&#x27;cuda&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Move the pipeline to the specified device (GPU).</span></span><br><span class="line">pipeline = pipeline.to(device)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Set a seed for random number generation to ensure reproducibility of the results.</span></span><br><span class="line">seed_everything(<span class="number">0</span>)</span><br></pre></td></tr></table></figure>

<h3 id="å›¾åƒå¤„ç†å’Œå¤šè§†å›¾åˆæˆåŠŸèƒ½"><a href="#å›¾åƒå¤„ç†å’Œå¤šè§†å›¾åˆæˆåŠŸèƒ½" class="headerlink" title="å›¾åƒå¤„ç†å’Œå¤šè§†å›¾åˆæˆåŠŸèƒ½"></a>å›¾åƒå¤„ç†å’Œå¤šè§†å›¾åˆæˆåŠŸèƒ½</h3><p>å®ç°è´Ÿè´£å›¾åƒé¢„å¤„ç†å’Œä»å•ä¸ªè¾“å…¥ç”Ÿæˆåˆæˆå¤šè§†å›¾å›¾åƒçš„å‡½æ•°, è¿™ä¸ªé˜¶æ®µé€šè¿‡transforms è¾“å…¥å¯ç”¨çš„ç©ºé—´ä¿¡æ¯ï¼Œå°†åˆå§‹è¾“å…¥è½¬æ¢ä¸ºé€‚åˆ 3D å»ºæ¨¡çš„æ ¼å¼ã€‚</p>
<p>é¢„å¤„ç†åŠŸèƒ½ï¼š</p>
<ul>
<li>preprocess å‡½æ•°æ—¨åœ¨å¯é€‰åœ°ä»è¾“å…¥å›¾åƒä¸­ç§»é™¤èƒŒæ™¯ã€‚è¿™ä¸€æ­¥éª¤å¯¹äºå°†æ¨¡å‹çš„æ³¨æ„åŠ›é›†ä¸­åœ¨å›¾åƒçš„ä¸»é¢˜ä¸Šå¹¶é¿å…å¼•å…¥å™ªéŸ³æ˜¯å¿…è¦çš„ã€‚</li>
<li>è°ƒæ•´å‰æ™¯å¤§å°ã€‚åœ¨å»é™¤èƒŒæ™¯åï¼Œå°†å‰æ™¯è°ƒæ•´ä¸ºå…¶åŸå§‹å¤§å°çš„ 85ï¼…æœ‰åŠ©äºæ ‡å‡†åŒ–è¾“å…¥å°ºå¯¸ï¼Œå¯èƒ½å‡å°‘å¤„ç†è¿‡ç¨‹ä¸­çš„è®¡ç®—è´Ÿè½½ã€‚</li>
</ul>
<p>å¤šè§†è§’åˆæˆ:</p>
<ul>
<li>generate_mvs å‡½æ•°ä½¿ç”¨æ‰©æ•£æ¨¡å‹ä»é¢„å¤„ç†å›¾åƒåˆ›å»ºå¤šä¸ªåˆæˆè§†å›¾ã€‚è¿™æ˜¯å¿…è¦çš„ï¼Œå› ä¸ºäººå·¥ç”ŸæˆåŒä¸€å¯¹è±¡çš„ä¸åŒè§†è§’å¯ä»¥å¢åŠ æ•°æ®é›†çš„ä¸°å¯Œæ€§ï¼Œå¹¶æ¨¡æ‹Ÿå¤šæ‘„åƒå¤´è®¾ç½®ã€‚</li>
<li>é€šè¿‡ä½¿ç”¨æ‰©æ•£æ¨¡å‹ï¼Œè¯¥åŠŸèƒ½åˆæˆä¿æŒä¸åŸå§‹å›¾åƒä¸Šä¸‹æ–‡ä¸€è‡´ä½†ä¸åŒè§’åº¦çš„æ–°è§†å›¾ã€‚</li>
<li>å›¾åƒé‡æ–°æ’åˆ—ã€‚åˆæˆè§†å›¾è¢«é‡æ–°æ’åˆ—æˆç½‘æ ¼æ ¼å¼ã€‚è¿™ä¸€æ­¥éª¤å¹¶ä¸ç®€å•ï¼Œå› ä¸ºå®ƒæ¶‰åŠåˆ°æ“çºµå›¾åƒå¼ é‡çš„å½¢çŠ¶å’Œå°ºå¯¸ï¼Œä»¥ä½¿å¤šä¸ªè§†å›¾å¯¹é½æ•´é½ã€‚</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">preprocess</span>(<span class="params">input_image, do_remove_background</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Preprocesses the input image by optionally removing the background.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Args:</span></span><br><span class="line"><span class="string">    input_image (PIL.Image): The image to preprocess.</span></span><br><span class="line"><span class="string">    do_remove_background (bool): Flag to determine if the background should be removed.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Returns:</span></span><br><span class="line"><span class="string">    PIL.Image: The preprocessed image.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># Create a new rembg session only if background removal is requested</span></span><br><span class="line">    rembg_session = rembg.new_session() <span class="keyword">if</span> do_remove_background <span class="keyword">else</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># If background removal is enabled, apply the removal process and resize the foreground</span></span><br><span class="line">    <span class="keyword">if</span> do_remove_background:</span><br><span class="line">        input_image = remove_background(input_image, rembg_session)  <span class="comment"># Remove the background</span></span><br><span class="line">        input_image = resize_foreground(input_image, <span class="number">0.85</span>)  <span class="comment"># Resize the foreground to 85% of its original size</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> input_image</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_mvs</span>(<span class="params">input_image, sample_steps, sample_seed</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Generates multi-view synthetic images from a single input image using a diffusion model.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Args:</span></span><br><span class="line"><span class="string">    input_image (PIL.Image): The image to process.</span></span><br><span class="line"><span class="string">    sample_steps (int): Number of inference steps for the diffusion process.</span></span><br><span class="line"><span class="string">    sample_seed (int): Seed for random number generation to ensure reproducibility.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Returns:</span></span><br><span class="line"><span class="string">    tuple: A tuple containing:</span></span><br><span class="line"><span class="string">        - z123_image (torch.Tensor): The raw tensor image from the diffusion model.</span></span><br><span class="line"><span class="string">        - show_image (PIL.Image): The rearranged image ready for display.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># Set a seed to ensure reproducibility in the generation process</span></span><br><span class="line">    seed_everything(sample_seed)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Create a new torch generator for random numbers on the specified device</span></span><br><span class="line">    generator = torch.Generator(device=device)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Generate a synthetic image using the diffusion pipeline</span></span><br><span class="line">    z123_image = pipeline(</span><br><span class="line">        input_image,</span><br><span class="line">        num_inference_steps=sample_steps,</span><br><span class="line">        generator=generator,</span><br><span class="line">    ).images[<span class="number">0</span>]  <span class="comment"># Access the first image from the generated set</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Convert the PyTorch tensor to a numpy array with type uint8</span></span><br><span class="line">    show_image = np.asarray(z123_image, dtype=np.uint8)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Rearrange the image dimensions to organize multiple views into a grid format for display</span></span><br><span class="line">    show_image = torch.from_numpy(show_image)  <span class="comment"># Convert numpy array back to PyTorch tensor</span></span><br><span class="line">    show_image = rearrange(show_image, <span class="string">&#x27;(n h) (m w) c -&gt; (n m) h w c&#x27;</span>, n=<span class="number">3</span>, m=<span class="number">2</span>)  <span class="comment"># Rearrange for multi-view</span></span><br><span class="line">    show_image = rearrange(show_image, <span class="string">&#x27;(n m) h w c -&gt; (n h) (m w) c&#x27;</span>, n=<span class="number">2</span>, m=<span class="number">3</span>)  <span class="comment"># Adjust the final layout</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Convert the final tensor back to a PIL image for easy display and manipulation</span></span><br><span class="line">    show_image = Image.fromarray(show_image.numpy())</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> z123_image, show_image</span><br></pre></td></tr></table></figure>

<h3 id="å›¾åƒåŠ è½½ã€å¤„ç†å’Œå¤šè§†å›¾ç”Ÿæˆ"><a href="#å›¾åƒåŠ è½½ã€å¤„ç†å’Œå¤šè§†å›¾ç”Ÿæˆ" class="headerlink" title="å›¾åƒåŠ è½½ã€å¤„ç†å’Œå¤šè§†å›¾ç”Ÿæˆ"></a>å›¾åƒåŠ è½½ã€å¤„ç†å’Œå¤šè§†å›¾ç”Ÿæˆ</h3><ul>
<li>å›¾åƒåŠ è½½ï¼šè¯¥è¿‡ç¨‹å§‹äºæŒ‡å®šè¾“å…¥å›¾åƒçš„è·¯å¾„ï¼Œå¹¶ä½¿ç”¨ Python Imaging Libraryï¼ˆPILï¼‰åŠ è½½å›¾åƒã€‚</li>
<li>èƒŒæ™¯å»é™¤å’Œå›¾åƒå¤„ç†ï¼šä½¿ç”¨å‰é¢è®¨è®ºè¿‡çš„ preprocess å‡½æ•°ï¼Œæˆ‘ä»¬å»é™¤åŠ è½½å›¾åƒçš„èƒŒæ™¯å¹¶è°ƒæ•´å¤§å°ã€‚</li>
<li>åˆæˆå¤šè§†å›¾ç”Ÿæˆï¼šç„¶åå°† generate_mvs å‡½æ•°åº”ç”¨äºé¢„å¤„ç†å›¾åƒï¼Œä»¥ç”Ÿæˆå¤šä¸ªåˆæˆè§†å›¾ã€‚æ­¤ç”Ÿæˆçš„å‚æ•° â€” ä¾‹å¦‚æ‰©æ•£è¿‡ç¨‹ä¸­çš„æ­¥æ•°ï¼ˆ75ï¼‰è¢«é€‰æ‹©ä»¥å¹³è¡¡è®¡ç®—éœ€æ±‚å’Œç”Ÿæˆè§†å›¾çš„è´¨é‡ä¹‹é—´çš„æƒè¡¡ã€‚</li>
<li>å›¾åƒä¿å­˜å’Œæ˜¾ç¤ºï¼šæ‰©æ•£è¿‡ç¨‹äº§ç”Ÿçš„åŸå§‹å¼ é‡å›¾åƒå’Œè§†è§‰ä¸Šæ’åˆ—çš„å¤šè§†å›¾å›¾åƒéƒ½ä¿å­˜åˆ°æŒ‡å®šè·¯å¾„ã€‚</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Define the path to the input image stored in the notebook&#x27;s workspace environment.</span></span><br><span class="line">input_image_path = <span class="string">&#x27;examples/bird.jpg&#x27;</span> <span class="comment">#@param &#123;type:&quot;string&quot;&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Open the image file from the specified path using PIL&#x27;s Image module.</span></span><br><span class="line">input_image = Image.<span class="built_in">open</span>(input_image_path)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Preprocess the input image by removing the background, leveraging the &#x27;preprocess&#x27; function.</span></span><br><span class="line">processed_image = preprocess(input_image, <span class="literal">True</span>)  <span class="comment"># Pass True to indicate background removal is needed.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Display the processed image; useful for verification in a Jupyter Notebook environment.</span></span><br><span class="line">processed_image</span><br><span class="line"></span><br><span class="line"><span class="comment"># Generate multi-view synthetic images from the preprocessed image using a diffusion model.</span></span><br><span class="line"><span class="comment"># Specify 75 steps for the diffusion process and a seed value of 42 for reproducibility.</span></span><br><span class="line">mv_images, mv_show_images = generate_mvs(processed_image, <span class="number">75</span>, <span class="number">42</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Define the path where the generated multi-view images will be saved.</span></span><br><span class="line">output_image_path = <span class="string">&#x27;mv_images.png&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Save the raw tensor image (not visually arranged) to the specified file path.</span></span><br><span class="line">mv_images.save(output_image_path)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Display the rearranged multi-view images, which are formatted for easy viewing.</span></span><br><span class="line"><span class="comment"># This output can be directly viewed in a Jupyter Notebook environment.</span></span><br><span class="line">mv_show_images</span><br></pre></td></tr></table></figure>
<p><img src="/../asset_singlleimageto3d/07.png"></p>
<h3 id="æ¨¡å‹é…ç½®"><a href="#æ¨¡å‹é…ç½®" class="headerlink" title="æ¨¡å‹é…ç½®"></a>æ¨¡å‹é…ç½®</h3><p>æˆ‘ä»¬è®¾ç½®æ“ä½œå‚æ•°ï¼Œä»å¤–éƒ¨æ¥æºåŠ è½½å¿…è¦çš„é…ç½®ï¼Œå¹¶ç¡®ä¿æ¨¡å‹åœ¨ç»™å®šç¡¬ä»¶ä¸Šæ€§èƒ½ä¼˜åŒ–ã€‚</p>
<p>é…ç½®åŠ è½½å’Œåº”ç”¨ã€‚</p>
<ul>
<li>OmegaConf ä»ä¸€ä¸ª YAML æ–‡ä»¶ä¸­åŠ è½½æ¨¡å‹çš„é…ç½®ã€‚è¿™ä¸€æ­¥æä¾›äº†ä¸€ç§çµæ´»ä¸”ç»“æ„åŒ–çš„æ–¹å¼æ¥ç®¡ç†è®¾ç½®å’Œæ“ä½œå‚æ•°ï¼Œå¯ä»¥åœ¨ä¸æ”¹å˜ä»£ç åº“çš„æƒ…å†µä¸‹è¿›è¡Œè°ƒæ•´ã€‚</li>
<li>æ­¤å¤–ï¼ŒYAML æ–‡ä»¶åŒ…å«å„ç§æ¨¡å‹æ–¹é¢çš„è§„èŒƒï¼ŒåŒ…æ‹¬æ¶æ„ç»†èŠ‚å’Œæ“ä½œå‚æ•°ï¼Œè¿™äº›è§„èŒƒæŒ‡å¯¼ç³»ç»Ÿåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­çš„è¡Œä¸ºã€‚</li>
</ul>
<p>æ¨¡å‹åˆå§‹åŒ–ã€‚</p>
<ul>
<li>æ ¹æ®ä¸Šä¸€æ­¥åŠ è½½çš„é…ç½®ï¼Œç³»ç»Ÿåˆ›å»ºä¸€ä¸ªæ¨¡å‹ã€‚è¿™æ¶‰åŠè®¾ç½®æ¨¡å‹æ¶æ„ï¼Œå¦‚åœ¨ YAML æ–‡ä»¶ä¸­æŒ‡å®šçš„é‚£æ ·ã€‚</li>
</ul>
<p>çŠ¶æ€å­—å…¸ç®¡ç†ã€‚</p>
<ul>
<li>ä»è¿œç¨‹å­˜å‚¨åº“ä¸‹è½½æ¨¡å‹åï¼Œç³»ç»Ÿå°†çŠ¶æ€å­—å…¸åŠ è½½åˆ°å®ä¾‹åŒ–çš„æ¨¡å‹ä¸­ã€‚è¯¥çŠ¶æ€å­—å…¸åŒ…å«ç»è¿‡è®­ç»ƒçš„æƒé‡å’Œåç½®ã€‚</li>
<li>çŠ¶æ€å­—å…¸çš„ç®¡ç†ç¡®ä¿æ¨¡å‹çš„æ‰€æœ‰ç»„ä»¶éƒ½æ­£ç¡®åœ°ä½¿ç”¨è®­ç»ƒå‚æ•°è¿›è¡Œåˆå§‹åŒ–ã€‚</li>
</ul>
<p>GPU åŠ é€Ÿè®¾å¤‡é…ç½®ã€‚</p>
<ul>
<li>å¦‚æœå¯ç”¨ï¼Œç³»ç»Ÿä¼šé…ç½®æ¨¡å‹åœ¨ GPU ä¸Šè¿è¡Œä»¥åŠ å¿«è®¡ç®—é€Ÿåº¦ã€‚è¿™ç§è®¾ç½®æ¶‰åŠå°†æ¨¡å‹çš„è®¡ç®—ä»»åŠ¡è½¬ç§»åˆ° GPU ä¸Šï¼Œä»¥ä¾¿é«˜æ•ˆåœ°å¤„ç†å¹¶è¡Œå¤„ç†ã€‚</li>
<li>è¿™ä¸€æ­¥å¤„ç†æ¶‰åŠ 3D å»ºæ¨¡å’Œå›¾åƒå¤„ç†çš„å¤æ‚è®¡ç®—ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç†å¤§æ•°æ®é‡æˆ–éœ€è¦å®æ—¶æ€§èƒ½æ—¶ã€‚</li>
</ul>
<p>FlexiCubes å‡ ä½•ç‰¹æ®Šé…ç½®ã€‚</p>
<ul>
<li>å¦å¤–ä¸€é¡¹æ£€æŸ¥è¯„ä¼°æ¨¡å‹æ˜¯å¦ä½¿ç”¨ FlexiCubesã€‚å¦‚æœ FlexiCubes æ˜¯é…ç½®çš„ä¸€éƒ¨åˆ†ï¼Œåˆ™ä¼šæ‰§è¡Œé¢å¤–çš„åˆå§‹åŒ–æ­¥éª¤æ¥è®¾ç½®è¿™ä¸ªå‡ ä½•ç»“æ„ã€‚</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Empty Cache and clear any previous pipeline references</span></span><br><span class="line">pipeline = <span class="literal">None</span></span><br><span class="line">torch.cuda.empty_cache()</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> torchvision.transforms <span class="keyword">import</span> v2</span><br><span class="line"><span class="keyword">from</span> omegaconf <span class="keyword">import</span> OmegaConf</span><br><span class="line"><span class="keyword">from</span> einops <span class="keyword">import</span> repeat</span><br><span class="line"><span class="keyword">import</span> tempfile</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"><span class="keyword">import</span> imageio</span><br><span class="line"><span class="keyword">from</span> src.utils.train_util <span class="keyword">import</span> instantiate_from_config</span><br><span class="line"><span class="keyword">from</span> src.utils.camera_util <span class="keyword">import</span> (FOV_to_intrinsics, get_zero123plus_input_cameras,get_circular_camera_poses,)</span><br><span class="line"><span class="keyword">from</span> src.utils.mesh_util <span class="keyword">import</span> save_obj, save_obj_with_mtl</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Define the path to the configuration file for the model.</span></span><br><span class="line">config_path = <span class="string">&#x27;configs/instant-mesh-base.yaml&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Load the configuration from the YAML file using OmegaConf.</span></span><br><span class="line">config = OmegaConf.load(config_path)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Extract the base name of the configuration file, removing the &#x27;.yaml&#x27; extension for use in conditional logic or naming.</span></span><br><span class="line">config_name = os.path.basename(config_path).replace(<span class="string">&#x27;.yaml&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Access specific configuration blocks for the model and inference from the loaded configuration.</span></span><br><span class="line">model_config = config.model_config</span><br><span class="line">infer_config = config.infer_config</span><br><span class="line"></span><br><span class="line"><span class="comment"># Download the model checkpoint from Hugging Face Hub, specifying the repository ID and filename.</span></span><br><span class="line">model_ckpt_path = hf_hub_download(repo_id=<span class="string">&quot;TencentARC/InstantMesh&quot;</span>, filename=<span class="string">&quot;instant_mesh_base.ckpt&quot;</span>, repo_type=<span class="string">&quot;model&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Instantiate the model using the configuration for the model.</span></span><br><span class="line">model = instantiate_from_config(model_config)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Load the model&#x27;s state dictionary from the checkpoint, ensuring it&#x27;s directed to CPU memory.</span></span><br><span class="line">state_dict = torch.load(model_ckpt_path, map_location=<span class="string">&#x27;cpu&#x27;</span>)[<span class="string">&#x27;state_dict&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Filter and adjust the keys in the state dictionary to match the expected format by removing a specific prefix and excluding any keys related to the &#x27;source_camera&#x27;.</span></span><br><span class="line">state_dict = &#123;k[<span class="number">14</span>:]: v <span class="keyword">for</span> k, v <span class="keyword">in</span> state_dict.items() <span class="keyword">if</span> k.startswith(<span class="string">&#x27;lrm_generator.&#x27;</span>) <span class="keyword">and</span> <span class="string">&#x27;source_camera&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> k&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Load the processed state dictionary into the model, ensuring a strict match.</span></span><br><span class="line">model.load_state_dict(state_dict, strict=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Set the device for model computation to GPU to accelerate processing.</span></span><br><span class="line">device = torch.device(<span class="string">&#x27;cuda&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Move the model to the specified device.</span></span><br><span class="line">model = model.to(device)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Check if the configuration name starts with &#x27;instant-mesh&#x27; to determine if FlexiCubes geometry initialization is required.</span></span><br><span class="line">IS_FLEXICUBES = <span class="literal">True</span> <span class="keyword">if</span> config_name.startswith(<span class="string">&#x27;instant-mesh&#x27;</span>) <span class="keyword">else</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># If the model uses FlexiCubes, initialize the FlexiCubes geometry with the specified field of view.</span></span><br><span class="line"><span class="keyword">if</span> IS_FLEXICUBES:</span><br><span class="line">    model.init_flexicubes_geometry(device, fovy=<span class="number">30.0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Set the model to evaluation mode, which disables training-specific behaviors like dropout.</span></span><br><span class="line">model = model.<span class="built_in">eval</span>()</span><br></pre></td></tr></table></figure>

<h3 id="3D-æ¨¡å‹ç”Ÿæˆå’Œå¯è§†åŒ–çš„åŠŸèƒ½"><a href="#3D-æ¨¡å‹ç”Ÿæˆå’Œå¯è§†åŒ–çš„åŠŸèƒ½" class="headerlink" title="3D æ¨¡å‹ç”Ÿæˆå’Œå¯è§†åŒ–çš„åŠŸèƒ½"></a>3D æ¨¡å‹ç”Ÿæˆå’Œå¯è§†åŒ–çš„åŠŸèƒ½</h3><p>å®ç°ä»å¤„ç†è¿‡çš„å›¾åƒç”Ÿæˆå’Œå¯è§†åŒ– 3D æ¨¡å‹çš„åŠŸèƒ½ã€‚</p>
<p>è¿™äº›åŠŸèƒ½å°†å¤šè§†å›¾å›¾åƒè½¬æ¢ä¸º 3D è¾“å‡ºï¼ˆMP4ã€å¯¹è±¡æ–‡ä»¶ç­‰ï¼‰ï¼Œå¯åœ¨å„ç§åº”ç”¨ä¸­è¿›è¡Œè¯„ä¼°å’Œåˆ©ç”¨ã€‚</p>
<ul>
<li>ä»å›¾åƒåºåˆ—åˆ›å»ºè§†é¢‘ï¼š images_to_video å‡½æ•°å°†å›¾åƒåºåˆ—è½¬æ¢ä¸ºè§†é¢‘æ–‡ä»¶ã€‚è¯¥å‡½æ•°ä¼šæ£€æŸ¥å’Œè½¬æ¢å›¾åƒæ•°æ®ï¼Œä»¥ç¡®ä¿å¸§å…·æœ‰æ­£ç¡®çš„æ ¼å¼å’Œå°ºå¯¸ï¼Œç„¶åå°†å®ƒä»¬ç¼–è¯‘æˆè§†é¢‘ã€‚</li>
<li>ç”¨äº 3D æ¸²æŸ“çš„ç›¸æœºå‚æ•°ç”Ÿæˆï¼š get_render_cameras è®¡ç®—å¹¶æä¾›æ¸²æŸ“ 3D æ¨¡å‹æ‰€éœ€çš„ç›¸æœºå‚æ•°ã€‚è¿™äº›å‚æ•°æ˜¯åŸºäºåœ†å½¢é…ç½®æ¨å¯¼å‡ºæ¥çš„ï¼Œæ¨¡æ‹Ÿäº†ä¸€ä¸ªçœŸå®çš„ç›¸æœºè®¾ç½®ï¼Œå¯ä»¥ä»å¤šä¸ªè§’åº¦æ•æ‰å¯¹è±¡ã€‚</li>
<li>3D ç½‘æ ¼ç”Ÿæˆï¼š make_mesh å‡½æ•°ä»æ¨¡å‹æä¾›çš„å¹³é¢æ•°æ®åˆ›å»º 3D ç½‘æ ¼ã€‚è¯¥å‡½æ•°ç”Ÿæˆç½‘æ ¼ï¼Œè¿˜å¯ä»¥é€‰æ‹©æ€§åœ°åº”ç”¨çº¹ç†æ˜ å°„ã€‚</li>
<li>å…¨é¢çš„ 3D æ¨¡å‹å’Œå¯è§†åŒ–ç”Ÿæˆï¼š make3d åŠŸèƒ½ç¼–æ’æ•´ä¸ªå°†å›¾åƒæ•°æ®è½¬æ¢ä¸º 3D ç½‘æ ¼å’Œç›¸åº”è§†é¢‘çš„è¿‡ç¨‹ã€‚å®ƒç®¡ç†ä»å¤„ç†åˆå§‹å›¾åƒã€è®¾ç½®ç›¸æœºå‚æ•°ã€ç”Ÿæˆç½‘æ ¼å¹³é¢ï¼Œæœ€åå°†è¾“å‡ºç¼–è¯‘æˆé™æ€ï¼ˆç½‘æ ¼ï¼‰å’ŒåŠ¨æ€ï¼ˆè§†é¢‘ï¼‰æ ¼å¼çš„å·¥ä½œæµç¨‹ã€‚</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">images_to_video</span>(<span class="params">images, output_path, fps=<span class="number">30</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Converts a sequence of images into a video file.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Args:</span></span><br><span class="line"><span class="string">    images (Tensor): A tensor of images to convert into video.</span></span><br><span class="line"><span class="string">    output_path (str): The file path where the video will be saved.</span></span><br><span class="line"><span class="string">    fps (int): Frames per second for the output video.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># Ensure the directory for the output path exists, create if not.</span></span><br><span class="line">    os.makedirs(os.path.dirname(output_path), exist_ok=<span class="literal">True</span>)</span><br><span class="line">    frames = []</span><br><span class="line">    <span class="comment"># Convert each image tensor to a numpy array, adjust for display, and collect frames.</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(images.shape[<span class="number">0</span>]):</span><br><span class="line">        frame = (images[i].permute(<span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>).cpu().numpy() * <span class="number">255</span>).astype(np.uint8).clip(<span class="number">0</span>, <span class="number">255</span>)</span><br><span class="line">        <span class="comment"># Ensure frame dimensions match expected dimensions.</span></span><br><span class="line">        <span class="keyword">assert</span> frame.shape[<span class="number">0</span>] == images.shape[<span class="number">2</span>] <span class="keyword">and</span> frame.shape[<span class="number">1</span>] == images.shape[<span class="number">3</span>], \</span><br><span class="line">            <span class="string">f&quot;Frame shape mismatch: <span class="subst">&#123;frame.shape&#125;</span> vs <span class="subst">&#123;images.shape&#125;</span>&quot;</span></span><br><span class="line">        <span class="comment"># Ensure pixel values are within the valid range.</span></span><br><span class="line">        <span class="keyword">assert</span> frame.<span class="built_in">min</span>() &gt;= <span class="number">0</span> <span class="keyword">and</span> frame.<span class="built_in">max</span>() &lt;= <span class="number">255</span>, \</span><br><span class="line">            <span class="string">f&quot;Frame value out of range: <span class="subst">&#123;frame.<span class="built_in">min</span>()&#125;</span> ~ <span class="subst">&#123;frame.<span class="built_in">max</span>()&#125;</span>&quot;</span></span><br><span class="line">        frames.append(frame)</span><br><span class="line">    <span class="comment"># Write the frames to a video file.</span></span><br><span class="line">    imageio.mimwrite(output_path, np.stack(frames), fps=fps, codec=<span class="string">&#x27;h264&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_render_cameras</span>(<span class="params">batch_size=<span class="number">1</span>, M=<span class="number">120</span>, radius=<span class="number">2.5</span>, elevation=<span class="number">10.0</span>, is_flexicubes=<span class="literal">False</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Generates camera parameters for 3D rendering based on a circular configuration.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Args:</span></span><br><span class="line"><span class="string">    batch_size (int): Number of camera sets to generate.</span></span><br><span class="line"><span class="string">    M (int): Number of camera positions.</span></span><br><span class="line"><span class="string">    radius (float): Radius of the camera circle.</span></span><br><span class="line"><span class="string">    elevation (float): Elevation angle of cameras.</span></span><br><span class="line"><span class="string">    is_flexicubes (bool): Flag to indicate if FlexiCubes geometry is used.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Returns:</span></span><br><span class="line"><span class="string">    Tensor: Camera parameters for rendering.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># Compute camera positions based on circular parameters.</span></span><br><span class="line">    c2ws = get_circular_camera_poses(M=M, radius=radius, elevation=elevation)</span><br><span class="line">    <span class="comment"># If using FlexiCubes, adjust camera parameters accordingly.</span></span><br><span class="line">    <span class="keyword">if</span> is_flexicubes:</span><br><span class="line">        cameras = torch.linalg.inv(c2ws)</span><br><span class="line">        cameras = cameras.unsqueeze(<span class="number">0</span>).repeat(batch_size, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        extrinsics = c2ws.flatten(-<span class="number">2</span>)</span><br><span class="line">        intrinsics = FOV_to_intrinsics(<span class="number">30.0</span>).unsqueeze(<span class="number">0</span>).repeat(M, <span class="number">1</span>, <span class="number">1</span>).<span class="built_in">float</span>().flatten(-<span class="number">2</span>)</span><br><span class="line">        cameras = torch.cat([extrinsics, intrinsics], dim=-<span class="number">1</span>)</span><br><span class="line">        cameras = cameras.unsqueeze(<span class="number">0</span>).repeat(batch_size, <span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> cameras</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">make_mesh</span>(<span class="params">mesh_fpath, planes</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Creates a 3D mesh with optional texture mapping.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Args:</span></span><br><span class="line"><span class="string">    mesh_fpath (str): File path for saving the mesh.</span></span><br><span class="line"><span class="string">    planes (Tensor): Planar data for mesh generation.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Returns:</span></span><br><span class="line"><span class="string">    str: The file path where the mesh is saved.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># Extract base filename and directory from path.</span></span><br><span class="line">    mesh_basename = os.path.basename(mesh_fpath).split(<span class="string">&#x27;.&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">    mesh_dirname = os.path.dirname(mesh_fpath)</span><br><span class="line">    <span class="comment"># Use texture mapping to save a detailed mesh.</span></span><br><span class="line">    <span class="keyword">with</span> torch.no_grad():</span><br><span class="line">        mesh_out = model.extract_mesh(planes, use_texture_map=<span class="literal">True</span>, **infer_config)</span><br><span class="line">        vertices, faces, uvs, mesh_tex_idx, tex_map = mesh_out</span><br><span class="line">        save_obj_with_mtl(</span><br><span class="line">            vertices.data.cpu().numpy(),</span><br><span class="line">            uvs.data.cpu().numpy(),</span><br><span class="line">            faces.data.cpu().numpy(),</span><br><span class="line">            mesh_tex_idx.data.cpu().numpy(),</span><br><span class="line">            tex_map.permute(<span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>).data.cpu().numpy(),</span><br><span class="line">            mesh_fpath,</span><br><span class="line">        )</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Mesh with texmap saved to <span class="subst">&#123;mesh_fpath&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> mesh_fpath</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">make3d</span>(<span class="params">images</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Generates a 3D mesh and a video of the mesh from images.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Args:</span></span><br><span class="line"><span class="string">    images (Tensor or array): Image data used for 3D generation.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Returns:</span></span><br><span class="line"><span class="string">    tuple: Paths to the generated video and mesh file.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># Convert image data to tensor and normalize.</span></span><br><span class="line">    images = np.asarray(images, dtype=np.float32) / <span class="number">255.0</span></span><br><span class="line">    images = torch.from_numpy(images).permute(<span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>).contiguous().<span class="built_in">float</span>()</span><br><span class="line">    <span class="comment"># Reorganize images for processing.</span></span><br><span class="line">    images = rearrange(images, <span class="string">&#x27;c (n h) (m w) -&gt; (n m) c h w&#x27;</span>, n=<span class="number">3</span>, m=<span class="number">2</span>)</span><br><span class="line">    <span class="comment"># Obtain camera parameters for input and rendering.</span></span><br><span class="line">    input_cameras = get_zero123plus_input_cameras(batch_size=<span class="number">1</span>, radius=<span class="number">4.0</span>).to(device)</span><br><span class="line">    render_cameras = get_render_cameras(</span><br><span class="line">        batch_size=<span class="number">1</span>, radius=<span class="number">4.5</span>, elevation=<span class="number">20.0</span>, is_flexicubes=IS_FLEXICUBES).to(device)</span><br><span class="line">    <span class="comment"># Resize images and move to GPU.</span></span><br><span class="line">    images = images.unsqueeze(<span class="number">0</span>).to(device)</span><br><span class="line">    images = v2.functional.resize(images, (<span class="number">320</span>, <span class="number">320</span>), interpolation=<span class="number">3</span>, antialias=<span class="literal">True</span>).clamp(<span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">    <span class="comment"># Prepare directory for temporary storage.</span></span><br><span class="line">    directory = <span class="string">&#x27;tmp&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(directory):</span><br><span class="line">        os.makedirs(directory)</span><br><span class="line">    tempfile.tempdir = directory</span><br><span class="line">    <span class="comment"># Create temporary files for mesh and video.</span></span><br><span class="line">    mesh_fpath = tempfile.NamedTemporaryFile(suffix=<span class="string">&quot;.obj&quot;</span>, delete=<span class="literal">False</span>).name</span><br><span class="line">    mesh_basename = os.path.basename(mesh_fpath).split(<span class="string">&#x27;.&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">    mesh_dirname = os.path.dirname(mesh_fpath)</span><br><span class="line">    video_fpath = os.path.join(mesh_dirname, <span class="string">f&quot;<span class="subst">&#123;mesh_basename&#125;</span>.mp4&quot;</span>)</span><br><span class="line">    <span class="comment"># Generate mesh planes and render frames for video.</span></span><br><span class="line">    <span class="keyword">with</span> torch.no_grad():</span><br><span class="line">        planes = model.forward_planes(images, input_cameras)</span><br><span class="line">        chunk_size = <span class="number">20</span> <span class="keyword">if</span> IS_FLEXICUBES <span class="keyword">else</span> <span class="number">1</span></span><br><span class="line">        render_size = <span class="number">384</span></span><br><span class="line">        frames = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(<span class="number">0</span>, render_cameras.shape[<span class="number">1</span>], chunk_size)):</span><br><span class="line">            <span class="keyword">if</span> IS_FLEXICUBES:</span><br><span class="line">                frame = model.forward_geometry(planes, render_cameras[:, i:i+chunk_size], render_size=render_size)[<span class="string">&#x27;img&#x27;</span>]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                frame = model.synthesizer(planes, cameras=render_cameras[:, i:i+chunk_size], render_size=render_size)[<span class="string">&#x27;images_rgb&#x27;</span>]</span><br><span class="line">            frames.append(frame)</span><br><span class="line">        frames = torch.cat(frames, dim=<span class="number">1</span>)</span><br><span class="line">        images_to_video(frames[<span class="number">0</span>], video_fpath, fps=<span class="number">30</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Video saved to <span class="subst">&#123;video_fpath&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="comment"># Save the mesh and return paths.</span></span><br><span class="line">    mesh_fpath = make_mesh(mesh_fpath, planes)</span><br><span class="line">    <span class="keyword">return</span> video_fpath, mesh_fpath</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Open the multi-view image file previously saved to check the output from the image generation process.</span></span><br><span class="line">mv_images = Image.<span class="built_in">open</span>(<span class="string">&#x27;mv_images.png&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Pass the opened multi-view images to the &#x27;make3d&#x27; function to generate a 3D model and a video visualization of the model.</span></span><br><span class="line">output_video, output_model_obj = make3d(mv_images)</span><br></pre></td></tr></table></figure>
<p>æ’­æ”¾ç”Ÿæˆçš„è§†é¢‘æ–‡ä»¶</p>
<p><img src="/../asset_singlleimageto3d/02.gif"></p>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a target="_blank" rel="noopener" href="https://medium.com/@crisvelasquez/3d-reconstructions-from-a-single-image-d53c387261b6">https://medium.com/@crisvelasquez/3d-reconstructions-from-a-single-image-d53c387261b6</a></p>

    </div>

    
    
    

    <footer class="post-footer">

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2024/05/27/deepQ/" rel="prev" title="å¼ºåŒ–å­¦ä¹ ï¼šæ·±åº¦ Q ç½‘ç»œ">
                  <i class="fa fa-angle-left"></i> å¼ºåŒ–å­¦ä¹ ï¼šæ·±åº¦ Q ç½‘ç»œ
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2024/06/04/ai-integration/" rel="next" title="å¦‚ä½•åœ¨åº”ç”¨ç¨‹åºä¸­é›†æˆAI">
                  å¦‚ä½•åœ¨åº”ç”¨ç¨‹åºä¸­é›†æˆAI <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Howard Huang</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="ç«™ç‚¹æ€»å­—æ•°">494k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="ç«™ç‚¹é˜…è¯»æ—¶é•¿">14:59</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="æ€»è®¿å®¢é‡">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="æ€»è®¿é—®é‡">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">
    <!--ç”± <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a> å¼ºåŠ›é©±åŠ¨-->
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="è¿”å›é¡¶éƒ¨">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.33/fancybox/fancybox.umd.js" integrity="sha256-+2+qOqR8CKoHh/AsVR9k2qaDBKWjYNC2nozhYmv5j9k=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  



  <script src="/js/third-party/fancybox.js"></script>



  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>





</body>
</html>
